<!DOCTYPE html>
<html lang="en">

<head>
  <!-- ## for client-side less
  <link rel="stylesheet/less" type="text/css" href="http://localhost:8000/theme/css/style.less">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/less.js/1.7.3/less.min.js" type="text/javascript"></script>
  -->
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/css/style.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/css/pygments.css">
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Sourav Chatterjee">
  <meta name="description" content="Posts and writings by Sourav Chatterjee">


<meta name="keywords" content="">

  <title>
    Data.Coffee.Code()
&ndash; Iowa polls  </title>


  <!-- Start of StatCounter Code for Default Guide -->
  <script type="text/javascript">
  var sc_project=('10783652');
  var sc_invisible=1;
  var sc_security=('24aa9956');
  var scJsHost = (("https:" == document.location.protocol) ?
  "https://secure." : "http://www.");
  document.write("<sc"+"ript type='text/javascript' src='" +
  scJsHost+
  "statcounter.com/counter/counter.js'></"+"script>");
  </script>
  <!-- End of StatCounter Code for Default Guide -->
</head>

<body>
  <aside>
    <div id="user_meta">
      <a href="http://localhost:8000">
        <img src="/images/your_logo.png" alt="logo">
      </a>
      <h2><a href="http://localhost:8000">Sourav Chatterjee</a></h2>
      <p></p>
      <ul>
        <li><a href="mailto:souravc83@gmail.com" target="_blank">Email</a></li>
        <li><a href="http://github.com/souravc83" target="_blank">Github</a></li>
        <li><a href="http://twitter.com/souravc83" target="_blank">Twitter</a></li>
      </ul>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href="http://localhost:8000">Index</a> &brvbar; <a href="http://localhost:8000/archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h3><a href="http://localhost:8000/iowa-polls.html">Iowa polls</a></h3>
  </div>
  <div class="article_text">
    
<h1>Iowa polls</h1>

<p>Everyone is staring hard at the polls in Iowa and trying to predict who the winners will be.
There are data gurus, there are journalists, and everyone in between. But are these Iowa polls 
that predictive. I looked at the last 10 days of polls in 2012.</p>

<pre><code class="r">library(xlsx)
</code></pre>

<pre><code>## Loading required package: rJava
</code></pre>

<pre><code>## Warning: package &#39;rJava&#39; was built under R version 3.2.3
</code></pre>

<pre><code>## Loading required package: xlsxjars
</code></pre>

<pre><code class="r">poll_raw &lt;- read.xlsx(&quot;polls.xlsx&quot;,1)
</code></pre>

<pre><code>## Error in loadWorkbook(file): Cannot find polls.xlsx
</code></pre>

<pre><code class="r">head(poll_raw)
</code></pre>

<pre><code>## Error in head(poll_raw): error in evaluating the argument &#39;x&#39; in selecting a method for function &#39;head&#39;: Error: object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">library(dplyr)
</code></pre>

<pre><code>## 
## Attaching package: &#39;dplyr&#39;
## 
## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union
</code></pre>

<pre><code class="r">poll_raw &lt;- select(poll_raw, -Date,-Spread,-Cain)
</code></pre>

<pre><code>## Error in select_(.data, .dots = lazyeval::lazy_dots(...)): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">poll_raw$Sample &lt;- as.double(gsub(&quot;\\sLV$&quot;,&quot;&quot;,poll_raw$Sample))
</code></pre>

<pre><code>## Error in gsub(&quot;\\sLV$&quot;, &quot;&quot;, poll_raw$Sample): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">actual &lt;- c(Paul=21.4, Romney=24.5, Santorum=24.6, Ginrich=13.3, Perry=10.3, Bachmann=5.0, Huntsman=0.6)

pool &lt;- dplyr::summarise(poll_raw,Poll=&quot;Pooled&quot;,Paul=sum(Sample*Paul)/sum(Sample),
                         Romney=sum(Sample*Romney)/sum(Sample), Santorum=sum(Sample*Santorum)/sum(Sample),
                         Gingrich=sum(Sample*Gingrich)/sum(Sample), Perry=sum(Sample*Perry)/sum(Sample),
                         Bachmann=sum(Sample*Bachmann)/sum(Sample),Huntsman=sum(Sample*Huntsman)/sum(Sample))
</code></pre>

<pre><code>## Error in summarise_(.data, .dots = lazyeval::lazy_dots(...)): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">pool$Sample &lt;- sum(poll_raw$Sample)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">poll_raw &lt;- rbind(poll_raw,pool)
</code></pre>

<pre><code>## Error in rbind(poll_raw, pool): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">candidate_plot &lt;-function(poll_df, actual_vec, cand_name)
{
  library(ggplot2)
  library(ggthemes)
  library(lazyeval)
  library(dplyr)
  cand_actual = as.numeric(actual_vec[cand_name])

  mutate_call &lt;- lazyeval::interp(~100.*1.96*sqrt( a/100.*(1.-a/100.)/b), a=as.name(cand_name), b=as.name(&quot;Sample&quot;))
  poll_df &lt;- poll_df%&gt;%mutate_(.dots=setNames(list(mutate_call),&quot;err_bar&quot;))

  cand_plot &lt;- ggplot(data=poll_df, environment=environment()) +geom_point(aes_string(x=&quot;Poll&quot;, y=cand_name)) +
                geom_errorbar(aes_string(x=&quot;Poll&quot;,ymin = paste0(cand_name,&quot;- err_bar&quot;), 
                                         ymax= paste0(cand_name,&quot;+ err_bar&quot;)), width=0.2, colour=2, size=1) +
               geom_hline(aes(yintercept = cand_actual)) +

               labs(x=&quot;Poll Name&quot;, y=cand_name, title=cand_name)  +
               theme_fivethirtyeight(base_size=24)+theme(axis.text.x = element_text(angle = 45, hjust = 1))

  return(cand_plot)
}
Paul_plot = candidate_plot(poll_raw, actual,&quot;Paul&quot;)
</code></pre>

<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.2.3
</code></pre>

<pre><code>## Warning: package &#39;ggthemes&#39; was built under R version 3.2.3
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">print(Paul_plot)
</code></pre>

<pre><code>## Error in print(Paul_plot): object &#39;Paul_plot&#39; not found
</code></pre>

<pre><code class="r">Romney_plot = candidate_plot(poll_raw, actual,&quot;Romney&quot;)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">print(Romney_plot)
</code></pre>

<pre><code>## Error in print(Romney_plot): object &#39;Romney_plot&#39; not found
</code></pre>

<pre><code class="r">Santorum_plot = candidate_plot(poll_raw, actual,&quot;Santorum&quot;)
</code></pre>

<pre><code>## Error in eval(expr, envir, enclos): object &#39;poll_raw&#39; not found
</code></pre>

<pre><code class="r">print(Santorum_plot)
</code></pre>

<pre><code>## Error in print(Santorum_plot): object &#39;Santorum_plot&#39; not found
</code></pre>


  </div>
  <div class="article_meta">
    <p>Posted on: Fri 22 January 2016</p>
    <p>Category: <a href="http://localhost:8000/category/misc.html">misc</a>
    </p>
  </div>

  <div id="article_comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_identifier = "iowa-polls.html";
        (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = 'http://souravc83githubio.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
    </script>
  </div>

</article>


    <div id="ending_message">
      <p>&copy; Sourav Chatterjee. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/gfidente/pelican-svbhack" target="_blank">github</a>. </p>
    </div>
  </main>
</body>
</html>