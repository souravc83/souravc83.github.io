<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Tale of Two Bandits: Bayesian and Greedy</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Data.Coffee.Code() </a></h1>
                <nav><ul>
                    <li><a href="/category/python.html">Python</a></li>
                    <li class="active"><a href="/category/python-ab-testing.html">Python, A/B testing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/tale-of-two-bandits-bayesian-and-greedy.html" rel="bookmark"
           title="Permalink to Tale of Two Bandits: Bayesian and Greedy">Tale of Two Bandits: Bayesian and Greedy</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-01-10T00:00:00-08:00">
                Published: Sun 10 January 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sourav-chatterjee.html">Sourav Chatterjee</a>
        </address>
<p>In <a href="/category/python-ab-testing.html">Python, A/B testing</a>.</p>

</footer><!-- /.post-info -->      <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><html><body><div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Bayesian-Bandit-and-the-Greedy-Bandit">The Bayesian Bandit and the Greedy Bandit<a class="anchor-link" href="#The-Bayesian-Bandit-and-the-Greedy-Bandit">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">999</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a quick post about various methods of multi armed bandits.
For those who are unfamiliar, multi-armed bandits are an interesting 
class of problems, that have everybody's attention these days, given their
importance in content experiments by internet companies.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bandit-in-a-Casino">Bandit in a Casino<a class="anchor-link" href="#Bandit-in-a-Casino">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the center of this puzzle is a Bandit, who has gained access to a casino, for a small amount of time. Before the police comes, the Bandit must make the most of his efforts to get access to the casino. Now the casino (and forgive my ignorance on the subject matter, I have never been to one!) consists of many machines with levers. You pull a lever, and a coin might come out. You could be unlucky and nothing could come out too. Each of these levers have a different probability of giving you money.</p>
<p>Of course, there are no guards and such, and no money to bet. So the bandit keeps on pulling the levers feverishly, and putting the coins in his knapsack. However, the Bandit has a problem. He does not know which lever gives how much money. However, the police is on its way. So it needs to make a decision. 
Should I pull the different levers to determine which is the best one? or should I just go with my knowledge from the pulls I have done, maximize my profit by pulling from the lever which <strong>I think</strong> is the best?
This is the famous <strong>explore-exploit dilemma</strong>, explore more, or exploit the current knowledge to make the most you can, of the situation?
At its heart, the Bandit problem boils down to a solution of this dilemma.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bandits-and-Internet-Experiments">Bandits and Internet Experiments<a class="anchor-link" href="#Bandits-and-Internet-Experiments">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The old bandit puzzle has gained a recent prominence, because it corresponds to a practical problem that today's internet companies face. Imagine you have 10 different versions of an website, which have been proposed to you by designers. Now, you want to find out which version do your customers like most. The term "like" here is very subjective. Depending upon your business needs, it can mean mean many things, for eg. are people buying from your site? are people clicking on outgoing links from your site etc.</p>
<p>So, how do you test each version of the site? You want to show it to customers. You don't want to spend too much time on the pages which are really bad, but you also don't want to come to a premature conclusion about what customers like or dislike, based on a 5 or 10 customers. Again, you are in the explore-exploit dilemma. So, imagine setting up the experiment the following way. Each website version is a casino machine. For each customer that arrives, you decide which machine they go to. If they buy stuff from that version of the site, you got your coin. If they smirk, and close the page, then your lever pull for that machine went into a waste. So, now, with this setting, how do you maximize your earnings?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bayesian-and-Greedy-Approaches">Bayesian and Greedy Approaches<a class="anchor-link" href="#Bayesian-and-Greedy-Approaches">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generally, multi armed bandit strategies can be divided into two types.
(1) Greedy strategies, like epsilon-greedy and epsilon first
(2) Bayesian strategy: Known as probability matching/Thompson sampling.
We will explain each of these strategies and run the code to execute them.
Let us try to compare the result of these three strategies.
<strong>TL;DR : Bayesians are wayyyy better than the greedy strategies.</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our framework is this:</p>
<p>There are five machines in the casino. They have probability of success 0.3, 0.4, 0.5, 0.6,0.7 respectively. However, the Bandits do not know this.The bandits have 1000 chances in total, before the police cars show up. We will try epsilon first, epsilon greedy and Thompson sampling to decide who wins.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c">#first create n bandits</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">Bandits</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prob_arr</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">prob_arr</span><span class="o">=</span> <span class="n">prob_arr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prob_arr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">success_arr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span> <span class="c">#keeps track of successes for each arm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_tries</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span> <span class="c">#keeps track of how many times each</span>
                                                  <span class="c"># arm is tried.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">empirical_prob</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span>
    
    <span class="k">def</span> <span class="nf">pull_this_arm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm_no</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">arm_no</span><span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">"Arm number is more than total bandits"</span><span class="p">)</span>
        
        <span class="c">#try this arm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_tries</span><span class="p">[</span><span class="n">arm_no</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">rand_no</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rand_no</span><span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prob_arr</span><span class="p">[</span><span class="n">arm_no</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">success_arr</span><span class="p">[</span><span class="n">arm_no</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">find_empirical_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">tries</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_tries</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">tries</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">empirical_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">tries</span>
    
    <span class="k">def</span> <span class="nf">find_best_arm_now</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_empirical_prob</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">empirical_prob</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">empirical_prob</span><span class="p">))</span>
    
    <span class="c">#this is the Thompson sampling</span>
    <span class="k">def</span> <span class="nf">find_best_thompson</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sample_from_beta</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_bandits</span><span class="p">):</span>
            <span class="n">sample_from_beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">beta</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">success_arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>\
                                                 <span class="mf">1.</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">total_tries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">success_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">best_bandit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">sample_from_beta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">best_bandit</span>
    
        
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Epsilon-first">Epsilon-first<a class="anchor-link" href="#Epsilon-first">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let us first use epsilon first strategy. What does the epsilon first strategy do?
This strategy first explores, for a given period of time, which is $\epsilon*T$, and then
based on the exploration it has done, it decides on the best bandit. The second phase is the pure exploitation phase
where it sticks to its decision, and only pulls the bandit which it decides is the best.
Let us see how this strategy performs?</p>
<p>Interesting to note, this is how we make many decisions in real life. Job interviews or elections are an example.
Candidates are explored for a given amount of time, and then we give the chance to the best one. A country sticks to 
its President/ Prime Minister for four/five years.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">epsilon_first</span><span class="p">(</span><span class="n">Band</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">,</span> <span class="n">total_draws</span><span class="p">):</span>
    <span class="n">money_earned</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">best_arm</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_draws</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="n">total_draws</span><span class="p">)</span><span class="o">&lt;</span><span class="n">eps_val</span><span class="p">:</span>
            <span class="c">#explore</span>
            <span class="n">pull_lever</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">pull_this_arm</span><span class="p">(</span><span class="n">pull_lever</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">money_earned</span> <span class="o">+=</span><span class="mf">1.</span>
                
        <span class="k">else</span><span class="p">:</span>
            <span class="c">#exploit</span>
            <span class="c">#if exploiting for the first time, find out</span>
            <span class="c">#which is the best arm.</span>
            <span class="k">if</span> <span class="n">best_arm</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">best_arm</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">find_best_arm_now</span><span class="p">()</span>
            
            <span class="n">result</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">pull_this_arm</span><span class="p">(</span><span class="n">best_arm</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">money_earned</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">money_earned</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, we have defined the epsilon first strategy. For a given value of epsilon, the code first finds whether we are in the 
exploration, or exploitation phase. If we are in the exploration phase, it randomly finds an arm and draws. Then, when it 
enters the exploitation phase, it finds the best arm it has seen so far, and sticks to it. It keeps drawing by pulling that
previously decided on "best arm" for all the subsequent chances. In the end, it returns how much money it has made.</p>
<p>But each time it will run, it will give a slightly different result. So, let us run it for a bunch of times, and see the distribution of the money it gives us. If this were an estimate, we would call it the sampling distribution of the estimate.
So, let us find the sampling distribution of the money we would earn, each time we do this. This will of course depend on what value of epsilon we choose. Lets first guess 0.2. We will then vary this guess and see what happens.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">tot_sims</span><span class="o">=</span><span class="mi">1000</span>
<span class="n">tot_draws</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">universal_bandit</span> <span class="o">=</span> <span class="n">Bandits</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">run_sim_many_times</span><span class="p">(</span><span class="n">sim_func</span><span class="p">,</span> <span class="n">tot_sims</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">):</span>
    <span class="n">eps_first_money</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">tot_sims</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_sims</span><span class="p">):</span>
        <span class="c">#Band_aid = Bandits([0.3,0.4,0.5]) #nice name for bandits!</span>
        <span class="n">Band_aid</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">universal_bandit</span><span class="p">)</span>
        <span class="n">eps_first_money</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim_func</span><span class="p">(</span><span class="n">Band_aid</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">,</span><span class="n">tot_draws</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">eps_first_money</span>

<span class="n">eps_first_0p2</span> <span class="o">=</span> <span class="n">run_sim_many_times</span><span class="p">(</span><span class="n">epsilon_first</span><span class="p">,</span> <span class="n">tot_sims</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

    
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">eps_first_0p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[12]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(array([  10.,    1.,    1.,   39.,   62.,   20.,   97.,  425.,  312.,   33.]),
 array([ 302. ,  324.8,  347.6,  370.4,  393.2,  416. ,  438.8,  461.6,
         484.4,  507.2,  530. ]),
 &lt;a list of 10 Patch objects&gt;)</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Should-we-explore-more?">Should we explore more?<a class="anchor-link" href="#Should-we-explore-more?">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That's an interesting question. I am sure there is a good statistical answer to where the optimum $\epsilon$ lies, but I 
cannot think of one off the top of my head. Why don't we brute force our way to an answer.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">eps_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">expected_eps_first</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eps_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">):</span>
    <span class="n">first_money</span> <span class="o">=</span> <span class="n">run_sim_many_times</span><span class="p">(</span><span class="n">epsilon_first</span><span class="p">,</span> <span class="n">tot_sims</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">)</span>
    <span class="n">expected_eps_first</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">first_money</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">,</span> <span class="n">expected_eps_first</span><span class="p">,</span><span class="s">'ro'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[15]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x110a81bd0&gt;]</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
Ws1iAAAAAElFTkSuQmCC
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span> <span class="n">expected_eps_first</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[300.02999999999997, 452.83100000000002, 466.90499999999997, 470.01400000000001, 468.75099999999998, 466.66399999999999, 463.78800000000001, 459.69999999999999, 457.24099999999999, 452.99200000000002, 448.99400000000003, 443.97500000000002, 439.56900000000002, 434.714, 429.51799999999997, 424.92200000000003, 419.315, 415.11000000000001, 409.43000000000001, 404.57299999999998, 399.12900000000002]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, just by luck, we were pretty close! What this shows is that exploring a lot does not gain you much. After $\epsilon=0.2$, exploring only diminishes your gains. So, now, let us look at the epsilon-greedy strategy.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Epsilon-Greedy">Epsilon Greedy<a class="anchor-link" href="#Epsilon-Greedy">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The epsilon-greedy strategy tries a slightly different tact. We choose greedily, i.e. based on what we know now, we choose. But sometimes, we choose randomly, in order to explore, i.e. we don't stop exploring entirely after a while. We explore intermittently while we explore. In case we were initially wrong, it gives us a chance at correction. Whether we explore or exploit, we will decide based on a random throw of the dice. We will generate a random number $X$ between 0 and 1. if $X

</p></div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">epsilon_greedy</span><span class="p">(</span><span class="n">Band</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">,</span> <span class="n">total_draws</span><span class="p">):</span>
    <span class="n">money_earned</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">best_arm</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">explore</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_draws</span><span class="p">):</span>
        <span class="n">random_draw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">high</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">random_draw</span><span class="o">&lt;</span><span class="n">eps_val</span><span class="p">:</span>
            <span class="n">explore</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">explore</span> <span class="o">=</span> <span class="bp">False</span>
            
        <span class="k">if</span> <span class="n">explore</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> 
            <span class="n">pull_lever</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">pull_this_arm</span><span class="p">(</span><span class="n">pull_lever</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">money_earned</span> <span class="o">+=</span><span class="mf">1.</span>   
        <span class="k">else</span><span class="p">:</span>
            <span class="n">best_arm</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">find_best_arm_now</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">pull_this_arm</span><span class="p">(</span><span class="n">best_arm</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">money_earned</span> <span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">money_earned</span>    
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, all we need to do, is run this function many times. We already have the framework for it, thanks to functional programming.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">eps_greedy_0p2</span> <span class="o">=</span> <span class="n">run_sim_many_times</span><span class="p">(</span><span class="n">epsilon_greedy</span><span class="p">,</span> <span class="n">tot_sims</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">eps_greedy_0p2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(array([   4.,    8.,   16.,   34.,   50.,  133.,  276.,  320.,  135.,   24.]),
 array([ 352. ,  369.1,  386.2,  403.3,  420.4,  437.5,  454.6,  471.7,
         488.8,  505.9,  523. ]),
 &lt;a list of 10 Patch objects&gt;)</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Well, clearly not very good, right. Okay, lets see if we can find an optimum, just like the last time. Again, similar code to previous case.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">expected_eps_greedy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eps_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">):</span>
    <span class="n">first_money</span> <span class="o">=</span> <span class="n">run_sim_many_times</span><span class="p">(</span><span class="n">epsilon_greedy</span><span class="p">,</span> <span class="n">tot_sims</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">,</span> <span class="n">eps_val</span><span class="p">)</span>
    <span class="n">expected_eps_greedy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">first_money</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_arr</span><span class="p">,</span> <span class="n">expected_eps_greedy</span><span class="p">,</span><span class="s">'bo'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[21]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x110d91350&gt;]</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AAAAAElFTkSuQmCC
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Around $460 just like last time, but a smaller value of epsilon is more useful. Okay, so this is the best the frequentists can do. Now, let us ask if the Bayesians can do any better?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bayesian-Bandits-aka-Thompson-sampling">Bayesian Bandits aka Thompson sampling<a class="anchor-link" href="#Bayesian-Bandits-aka-Thompson-sampling">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, do Thompson sampling. The logic of the Thomson sampling lies in the function named find_best_thompson() in the Bandit class. What does this function do?</p>
<p>For each machine, it constructs a beta distribution as a prior. By multiplying it with the likelihood of getting a success, it constructs the posterior distribution for each machine. This posterior corresponds to our belief at a time point on what the true probability of success is, if we draw from that machine. In each step, it samples from each of the posterior distributions. It then chooses the sample with the highest probability. If one machine stands out, clearly, it will be the maximum in most cases, when samples are drawn, and correspond to the exploit phase.
Whereas, if two machine have similar posterior distribution, this means, to a Bayesian, from our knowledge, we aren't very sure, who is better. So, in a sense then, the maximum is more likely to come from either distribution. In plain English, this is how Thompson sampling solves the explore exploit dilemma.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">bayesian_bandit</span><span class="p">(</span><span class="n">Band</span><span class="p">,</span> <span class="n">total_draws</span><span class="p">):</span>
    <span class="n">money_earned</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_draws</span><span class="p">):</span>
        <span class="n">pull_lever</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">find_best_thompson</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">Band</span><span class="o">.</span><span class="n">pull_this_arm</span><span class="p">(</span><span class="n">pull_lever</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">money_earned</span> <span class="o">+=</span><span class="mf">1.</span>
    <span class="k">return</span> <span class="n">money_earned</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we want to run all the three. Our main aim is to see who earns the most money?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">thompson_earning</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">tot_sims</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tot_sims</span><span class="p">):</span>
    <span class="n">Band_aid</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">universal_bandit</span><span class="p">)</span>
    <span class="n">thompson_earning</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bayesian_bandit</span><span class="p">(</span><span class="n">Band_aid</span><span class="p">,</span> <span class="n">tot_draws</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How well does Thompson sampling do, on average?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">thompson_earning</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>671.139
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What did the distribution look like?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">thompson_earning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(array([   6.,    4.,    7.,   28.,   79.,  246.,  348.,  222.,   56.,    4.]),
 array([ 562. ,  579.4,  596.8,  614.2,  631.6,  649. ,  666.4,  683.8,
         701.2,  718.6,  736. ]),
 &lt;a list of 10 Patch objects&gt;)</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAe4AAAFXCAYAAABk0q3rAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAGM5JREFUeJzt3X+QXfV53/G3kJATZTUCmZUASbWA0ZNBbhwgrSYZ1z+L
M7hpJTyZ4cfUExrh1FO5QD0NDaJtYtqOapugMU6CpyngyolRUB2DxbhMBDTJxDO2wUywCaJ9DGIR
orBa2EXRWngirbZ/3CO4Frv3Lnvv1T3f3ffrnz3ne86593nm3u9+9pz7Y0GSJEmSJEmSJEmSJEmS
JEmSJEmSVIAFrTZGxE8Bfwm8A1gMfCMzt0bEZ4BPACPVrjdn5oPVMVuBzcAEcH1m7ulR7ZIkzTst
gxsgIpZk5pGIWAR8C/hN4B8DhzNz+0n7rgfuAf4hsAp4GIjMPN71yiVJmodOa7dDZh6pFhcDC4Gx
an2q0N8E7MzMo5k5BDwDbOhCnZIkiRkEd0ScFhFPAMPAn2fmU9Wm6yLi+xFxV0ScUY2dCxxoOvwA
jTNvSZLUBTM54z6emRcBq4H3R8QHgS8B5wEXAS8Bt7W4icku1ClJkoBFM90xMw9FxDeBf5CZf3Fi
PCLuBB6oVl8E1jQdtroam9bx48cnFyxo+1K7JElzwoIOQ69lcEfEWcCxzHwtIn4a+AhwS0ScnZkv
V7t9DHiyWt4N3BMR22lcIl8HPNqmAUZGDnfSQ98NDi4tvgewjzqZCz1AZ31MTEwwNLSvyxW9fcuX
DzA6Ot52v7Vrz2fhwoWnoKLZ8Tk1d7Q74z4H2BERp9G4rP5HmflIRHwlIi6icRn8OeCTAJm5NyJ2
AXuBY8CWzPRSuaS3bWhoHzfcupsly1b0u5S2jhw6yO03buSCC9b1uxTNAy2DOzOfBC6ZYvzXWhyz
DdjWeWmS5rsly1YwcKbvb5WatX1zmiRJqg+DW5KkghjckiQVxOCWJKkgBrckSQUxuCVJKojBLUlS
QQxuSZIKYnBLklQQg1uSpIIY3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmSCmJwS5JUEINb
kqSCGNySJBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5KkghjckiQVxOCWJKkg
BrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIkFWRRq40R8VPAXwLvABYD38jMrRGx
HLgXeBcwBFyRma9Vx2wFNgMTwPWZuad35UuSNL+0POPOzB8DH8rMi4D3AB+KiH8E3AQ8lJkBPFKt
ExHrgSuB9cBlwB0R4Vm9JEld0jZUM/NItbgYWAiMARuBHdX4DuDyankTsDMzj2bmEPAMsKGbBUuS
NJ+1De6IOC0ingCGgT/PzKeAlZk5XO0yDKysls8FDjQdfgBY1cV6JUma12Zyxn28ulS+Gnh/RHzo
pO2TwGSLm2i1TZIkvQ0t35zWLDMPRcQ3gV8AhiPi7Mx8OSLOAQ5Wu70IrGk6bHU11tLg4NK3UXI9
zYUewD7qZC70ALPvY2xsoMuV9Nby5QO1f8zqXt9MzZU+Zqvdu8rPAo5l5msR8dPAR4BbgN3ANcDn
qp/3V4fsBu6JiO00LpGvAx5tV8TIyOFZN1AHg4NLi+8B7KNO5kIP0Fkfo6PjXa6mt0ZHx2v9mPmc
mjvaXSo/B/jf1Wvc3wUeyMxHgM8CH4mIBD5crZOZe4FdwF7gQWBLdSldkiR1Qcsz7sx8ErhkivFR
4NJpjtkGbOtKdZIk6Sf4GWtJkgpicEuSVBCDW5KkghjckiQVxOCWJKkgBrckSQUxuCVJKojBLUlS
QQxuSZIKYnBLklQQg1uSpIIY3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmSCmJwS5JUEINb
kqSCGNySJBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5KkghjckiQVxOCWJKkg
BrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIsarUxItYAXwFWAJPAH2bmFyPiM8AngJFq
15sz88HqmK3AZmACuD4z9/SodkmS5p2WwQ0cBT6dmU9ExADweEQ8RCPEt2fm9uadI2I9cCWwHlgF
PBwRkZnHe1C7JEnzTstL5Zn5cmY+US2PA0/TCGSABVMcsgnYmZlHM3MIeAbY0L1yJUma32b8GndE
rAUuBr5TDV0XEd+PiLsi4oxq7FzgQNNhB3gz6CVJUodmFNzVZfKvATdUZ95fAs4DLgJeAm5rcfhk
p0VKkqSGdq9xExGnA38K/HFm3g+QmQebtt8JPFCtvgisaTp8dTXW0uDg0rdRcj3NhR7APupkLvQA
s+9jbGygy5X01vLlA7V/zOpe30zNlT5mq927yhcAdwF7M/MLTePnZOZL1erHgCer5d3APRGxncYl
8nXAo+2KGBk5PIvS62NwcGnxPYB91Mlc6AE662N0dLzL1fTW6Oh4rR8zn1NzR7sz7vcCHwd+EBF/
XY3dDFwdERfRuAz+HPBJgMzcGxG7gL3AMWBLZnqpXKqJiYkJhob2nbL7GxsbmHUA79//fJerkeaG
lsGdmd9i6tfBH2xxzDZgW4d1SeqBoaF93HDrbpYsW9HvUtp69cDTvHP1hf0uQ6qdtq9xS5pblixb
wcCZ9f+wx5FDw/0uQaolv/JUkqSCGNySJBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5JkgpicEuS
VBCDW5KkghjckiQVxOCWJKkgBrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIkFWRR
vwuQpNJNHj/O/v3P97uMlsbGBhgdHQdg7drzWbhwYZ8r0mwZ3JLUodcPj3Dbva+wZNlL/S6lrSOH
DnL7jRu54IJ1/S5Fs2RwS1IXLFm2goEzV/W7DM0DvsYtSVJBDG5JkgpicEuSVBCDW5KkghjckiQV
xOCWJKkgBrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIkFaTlfweLiDXAV4AVwCTw
h5n5xYhYDtwLvAsYAq7IzNeqY7YCm4EJ4PrM3NO78iVJml/anXEfBT6dme8GfhH4VERcCNwEPJSZ
ATxSrRMR64ErgfXAZcAdEeFZvSRJXdIyVDPz5cx8oloeB54GVgEbgR3VbjuAy6vlTcDOzDyamUPA
M8CGHtQtSdK8NOOz4YhYC1wMfBdYmZnD1aZhYGW1fC5woOmwAzSCXpIkdUHL17hPiIgB4E+BGzLz
cES8sS0zJyNissXhrbYBMDi4dCZl1Npc6AHso0560cPY2EDXb1PlWb58oOg5UnLt3dA2uCPidBqh
/UeZeX81PBwRZ2fmyxFxDnCwGn8RWNN0+OpqrKWRkcNvr+qaGRxcWnwPYB910qseRkfHu36bKs/o
6Hixc2QuzO9OtbxUHhELgLuAvZn5haZNu4FrquVrgPubxq+KiMURcR6wDni0uyVLkjR/tTvjfi/w
ceAHEfHX1dhW4LPAroi4lurjYACZuTcidgF7gWPAlsxse6lckiTNTMvgzsxvMf1Z+aXTHLMN2NZh
XZIkaQp+xlqSpIIY3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmSCmJwS5JUEINbkqSCGNyS
JBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5KkghjckiQVxOCWJKkgBrckSQUx
uCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmS
CmJwS5JUEINbkqSCGNySJBXE4JYkqSCL2u0QEXcDvwIczMyfq8Y+A3wCGKl2uzkzH6y2bQU2AxPA
9Zm5pwd1S5I0L7UNbuDLwO8BX2kamwS2Z+b25h0jYj1wJbAeWAU8HBGRmce7VK8kSfNa20vlmflX
wNgUmxZMMbYJ2JmZRzNzCHgG2NBRhZIk6Q2dvMZ9XUR8PyLuiogzqrFzgQNN+xygceYtSZK6YCaX
yqfyJeA/Vcv/GbgNuHaafSfb3djg4NJZllEfc6EHsI866UUPY2MDXb9NlWf58oGi50jJtXfDrII7
Mw+eWI6IO4EHqtUXgTVNu66uxloaGTk8mzJqY3BwafE9gH3USa96GB0d7/ptqjyjo+PFzpG5ML87
NatL5RFxTtPqx4Anq+XdwFURsTgizgPWAY92VqIkSTphJh8H2wl8ADgrIl4Afgf4YERcROMy+HPA
JwEyc29E7AL2AseALZnZ9lK5JEmambbBnZlXTzF8d4v9twHbOilKkiRNzW9OkySpIAa3JEkFMbgl
SSqIwS1JUkEMbkmSCmJwS5JUEINbkqSCGNySJBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5Jkgpi
cEuSVBCDW5KkghjckiQVxOCWJKkgBrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIk
FcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmSCmJwS5JUEINbkqSCGNySJBXE4JYkqSAGtyRJBVnU
boeIuBv4FeBgZv5cNbYcuBd4FzAEXJGZr1XbtgKbgQng+szc05vSJUmaf2Zyxv1l4LKTxm4CHsrM
AB6p1omI9cCVwPrqmDsiwrN6SZK6pG2oZuZfAWMnDW8EdlTLO4DLq+VNwM7MPJqZQ8AzwIbulCpJ
kmZ7NrwyM4er5WFgZbV8LnCgab8DwKpZ3ockSTpJx5exM3MSmGyxS6ttkiTpbWj75rRpDEfE2Zn5
ckScAxysxl8E1jTtt7oaa2lwcOksy6iPudAD2Eed9KKHsbGBrt+myrN8+UDRc6Tk2rthtsG9G7gG
+Fz18/6m8XsiYjuNS+TrgEfb3djIyOFZllEPg4NLi+8B7KNOetXD6Oh4129T5RkdHS92jsyF+d2p
mXwcbCfwAeCsiHgB+G3gs8CuiLiW6uNgAJm5NyJ2AXuBY8CW6lK6JEnqgrbBnZlXT7Pp0mn23wZs
66QoSZI0NT9jLUlSQQxuSZIKYnBLklQQg1uSpIIY3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEM
bkmSCmJwS5JUEINbkqSCGNySJBXE4JYkqSBt/62npOlNTEwwNLSv67c7NjbA6Oh41293//7nu36b
kk4tg1vqwNDQPm64dTdLlq3odykz8uqBp3nn6gv7XYakDhjcUoeWLFvBwJmr+l3GjBw5NNzvEiR1
yNe4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5KkghjckiQVxOCWJKkgBrckSQUxuCVJKojBLUlSQQxu
SZIKYnBLklQQg1uSpIIY3JIkFcTgliSpIAa3JEkFMbglSSrIon4XIEk6dSaPH2f//uf7XcaMrV17
PgsXLux3GbXSUXBHxBDwt8AEcDQzN0TEcuBe4F3AEHBFZr7WYZ2SpC54/fAIt937CkuWvdTvUto6
cuggt9+4kQsuWNfvUmql0zPuSeCDmTnaNHYT8FBmfj4ifqtav6nD+5EkdcmSZSsYOHNVv8vQLHXj
Ne4FJ61vBHZUyzuAy7twH5Ikic6DexJ4OCK+FxG/UY2tzMzhankYWNnhfUiSpEqnwf3ezLwY+Cjw
qYh4X/PGzJykEe6SJKkLOnqNOzNfqn6ORMR9wAZgOCLOzsyXI+Ic4GC72xkcXNpJGbUwF3oA+3i7
xsYGTsn9SPPV8uUDb5nPc+X31GzNOrgjYgmwMDMPR8TPAL8M3ALsBq4BPlf9vL/dbY2MHJ5tGbUw
OLi0+B7APmZjdHT8lNyPNF+Njo7/xHyeK7+nOtHJGfdK4L6IOHE7X83MPRHxPWBXRFxL9XGwjquU
JElAB8Gdmc8BF00xPgpc2klRkiRpan7lqSRJBTG4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5Kkghjc
kiQVxOCWJKkgBrckSQUxuCVJKojBLUlSQQxuSZIKYnBLklQQg1uSpIJ08v+4pZ6YmJhgaGjfrI8f
GxtgdHS8ixVNb//+50/J/UjSCQa3amdoaB833LqbJctW9LuUtl498DTvXH1hv8uQNI8Y3KqlJctW
MHDmqn6X0daRQ8P9LkHSPONr3JIkFcTgliSpIAa3JEkFMbglSSqIwS1JUkEMbkmSCmJwS5JUEINb
kqSCGNySJBXE4JYkqSAGtyRJBTG4JUkqiMEtSVJBDG5JkgpicEuSVBCDW5KkgizqdwE6NSYmJhga
2tdyn7GxAUZHx09RRdPbv//5fpcgSbVVu+D+9mOP8xffearfZczI60fGuXHLxxkcXNrvUtoaGtrH
DbfuZsmyFf0upa1XDzzNO1df2O8yJKmWehLcEXEZ8AVgIXBnZn5upsc+s+95fvij1b0oq+t+NPIs
Tz31Nxw79qNanKm2sn//8yxZtoKBM1f1u5S2jhwa7ncJkmpg8vjxt1yBq8uVwamsXXs+Cxcu7Pn9
dD24I2Ih8PvApcCLwGMRsTszn+72ffXb64df4b/8j2+zZNmz/S6lLc9iJZXm9cMj3HbvKyxZ9lK/
S2nryKGD3H7jRi64YF3P76sXZ9wbgGcycwggIv4E2ATMueAGPIuVpB4q5XfsqdSLd5WvAl5oWj9Q
jUmSpA714ox7spOD33H6Io6/+mS3aump4+P7OXLa4n6XMSOvHx4FFvS7jBmx1t4pqV5r7Q1r7Y0j
hw6esvvqRXC/CKxpWl9D46x7SgsWLCjjUZEkqYVf+votp+R+ehHc3wPWRcRa4P8BVwJX9+B+JEma
d7r+GndmHgP+NfBnwF7g3rn4jnJJkiRJkiRJkiRJkiRJ0vR6/lGsiBgC/haYAI5m5oZq/DpgSzX+
zcz8rWp8K7C5Gr8+M/f0usaZmKqPiNhA4+tdTweOAVsy87Fq/9r1ERFnAHcC76bxeftfB34I3Au8
CxgCrsjM16r9a9cDTNnHZuBXgX8K/B3wLPDrmXmo2r92fUzVQ2Z+p9r2b4FbgbMyc7Qaq10PMPVz
KjO/W+D8nuo5dRz4Axqfvqn1/I6InwX+pGnofOA/An9MQfN7mj5+G1hNIfN7usciM79Ybe94fp+K
/8c9CXwwMy9uCu0PARuB92Tm3wd+txpfT+PjY+uBy4A7IqIu/zP8LX0An6fxgFxM48n1eah1H7cD
/yszLwTeA/wf4CbgocwM4JFqvc49wFv7eBrYA7w7M38eSGAr1LqPqXogItYAHwHe+M8KNe4BpnhO
FTq/p3o8Pg/8hxLmd2b+3+p308XALwBHgPsobH5P08fXKWh+t3gsuja/T1WDJ5/Z/yvgv2bmUYDM
HKnGNwE7M/No9V3nz9D47vO6OLmPl4Bl1fIZNL58BmrYR0QsA96XmXdD42N71V+sG4Ed1W47gMur
5dr1ANP3kZkPZebxarfv0vgLHWrYR4vHAmA78O9OOqR2PUDLPoqa3y36KGZ+n+RSGv8v4gUKm98n
uRR4NjNfKGl+n+SNHqr1rszvU/H/uCeBhyNiAvhvmfnfgXXA+yNiG/Bj4Dcz83vAucB3mo6t0/ec
T9XHTcC3IuJ3afwR9EvVvnXs4zxgJCK+DPw88Djwb4CVmXniP5AMAyur5Tr2AFP3cUNmHmnaZzOw
s1quYx9T9kDjL/EDmfmDiGjev449wPTPqdLm93SPR0nzu9lVvPn8L21+N7sKuGeK8brP72Zv9BAR
m+jS/D4VZ9zvrS4ZfBT4VES8j8YfDGdm5i8CNwK7Whzf0Xefd9FUfdxF4/WIvwd8Gri7xfH97mMR
cAlwR2ZeAvyI6rLZCZk5Ses6+90DtOkjIv498HeZOdWEP6HffUzVwy00Lv/9TtN+rd6D0u8eYPrH
orT5PVUfWylrfgMQEYuBfwb8z5O3FTK/gen7KGR+Az/ZQ0QsAW6mS/O758GdmS9VP0doXOffQOMv
iq9X448BxyPiLN76PeerefPyVF9N08eGzLyv2uVrvHl5o459HKDx195j1frXaPyyejkizgaIiHOA
E9+UX8ceYPo+iIh/AfwT4J837V/HPqbq4WJgLfD9iHiORp2PR8RK6tkDTN/HC5Q1v6d7TpU0v0/4
KPB408sTw4XN7xNO7qOk+X1Ccw8X0MX53dPgjoglEbG0Wv4Z4JeBJ4H7gQ9X4wEszsxXgN3AVRGx
OCLOo3HJ7dFe1jgT0/TxN8AzEfGBarcP03jTBNSwj8x8GXgh3rxGcynwFPAAcE01dg2NxwZq2ANM
30dEXEbj7G5TZv646ZDa9TFND49n5tmZeV5mnkcjTC6pLnPWrgdo+Zz6BgXN7xZ9/LCU+d3kat68
jAyNWouZ301+oo+S5neTN3rIzCczc2W35nevX+NeCdxXzYdFwFczc09EnA7cHRFP0nh7/68BZObe
iNhF4zvOT3z8og6XPabq488i4lXgDyLiHcDrwL+EWvdxHfDV6hLOszQ+DrYQ2BUR11J9XARq3QO8
tY/NwGPAYuCh6nH6dmZuqXEfUz0Wzd6oscY9wNR9HKGs+Q1T97GLguZ3dVJxKfAbTcOfpbD5PU0f
v0dB83uaHpqVMr8lSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIkqV7+P0HlLSXEh1TfAAAAAElFTkSu
QmCC
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow! even the worst Thompson sampling is at around 560, which beats the best epsilon greedy or epsilon first by ~$100.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us plot the three methods side by side, to get a sense of how good the Bayesian sampling is, compared to the 
epsilon first, and epsilon greedy.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c">#thompson_normal = [w/max(thompson_earning) for w in thompson_earning]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_arr</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">expected_eps_first</span><span class="p">,</span><span class="s">'ro'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Earnings"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eps_arr</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">expected_eps_greedy</span><span class="p">,</span><span class="s">'bo'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">thompson_earning</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">hist</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[44]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes.AxesSubplot at 0x112afe850&gt;</pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
r9uUvbn0ic/3CmquRiZJ86/SSb9Offpz7RPvhb5q+6YlaX5VOunXqU9/rn3i9lVLkiqd9KtQ3m/X
NDXL45Kkuap00u/18n67p6lZHpckzUWlk36vl/erMk1NklQPdvJKklQTlb7T71af/mz75e2HlyT1
kkon/W706c+1X95+eElSr6h00u9Gn7798pKkhaLSSb8b5f0ndu9ix47+0scPDCxl0aIef5ScJKmW
Kp30u1HeX3zMMXz3/sdZtOjI/fO7d+3kghf8glUBSVJPqnTS7/Upe5Ik9ZJKJ/1eWZFvYnS/o/Ul
Sb2s0km/F1bkO3R0v6P1JUm9qtJJvxfK+47ulyRVhSvySZJUE5W+029nn76r7kmSFrpKJ/129em7
6p4kqQ4qnfTb1advv7wkqQ4qnfQPLe9bopckaWqVTvqt5X1L9JIkTa/SSb+1vG+JXpKk6TllT5Kk
mqj0nX5rn/5kT8PziXeSJB3Q8aQfEScA1wCnAQ3gLcCPgM8ATwc2A6/LzEeL49cClwH7gSsy8+ap
rt3ap3/o0/B84p0kSQfrRnn/z4AvZeazgdOBHwBXArdkZgC3FdtExGrgEmA18HLgIxExZRuXDw6x
fMXwU//1L1nK8f0DHN8/wHHH9091miRJtdTRO/2IWAacm5lvBsjMfcD2iLgIOK84bD3wNZqJfw2w
ITP3Apsj4j7gHOCfJrv+dFP2nIYnSdLBOl3ePwUYi4hPAGcA3wZ+GxjKzG3FMduAoeL1yRyc4EeB
kakufqQpe07DkyTpgE4n/aOBs4DfysxvRsSHKUr5EzKzERHTLaY75XvLB4foX9JM7Dsff4xTThlh
2TL78KcyODgw302oBONUjnEqz1iVY5w6r9NJfxQYzcxvFts3AmuBByPipMx8MCKGgYeK97cAq1rO
X1nsm9SuXTt5fOeTQLOc//DDJ7Jnj7MQJzM4OMDY2I75bkbPM07lGKfyjFU5xqk7Opr0i6T+QERE
ZiZwPnBv8d+bgQ8Uf36+OGUjcF1ErKNZ1j8VuGuq65/33BH27j2Q5C3nS5I0tW7M038X8OmIWAz8
mOaUvaOAGyLirRRT9gAyc1NE3ABsAvYBl2fmlOX9ZcuWeWcvSVJJHU/6mXkP8PxJ3jp/iuOvBq7u
aKMkSaqhSq/It3379oPK+9NxdT5JUt1VOul//e4tjDeO/CO4Op8kSRVP+scf3//UU/YkSdL0Kp30
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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre> 
</pre></div>
</div>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>