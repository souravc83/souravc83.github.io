<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Data.Coffee.Code()</title><link>http://souravc83.github.io/</link><description></description><atom:link href="http://souravc83.github.io/feeds/misc.rss.xml" rel="self"></atom:link><lastBuildDate>Sat, 20 Feb 2016 00:00:00 -0800</lastBuildDate><item><title>What's wrong with histograms and what are density estimators?</title><link>http://souravc83.github.io/whats-wrong-with-histograms-and-what-are-density-estimators.html</link><description>&lt;h1&gt;Estimating Probablity Densities&lt;/h1&gt;
&lt;p&gt;The other day I was reading Parzen's density estimators in Bishop. Density estimators are a non-parametric way of estimating the underlying probability distributions, that might have generated the data 
that you are handed over. Parametric methods consist of assuming a distribution, and then estimating
the parameters of the distribution, that are most likely to have generated that data (MLE/MAP etc.).
Non-parametric estimations however, make no such assumptions.
The simplest non-parametric estimation? You have probably used it several times, without realizing it.
Its the humble histogram!&lt;/p&gt;
&lt;h2&gt;Visualizing data: Histograms&lt;/h2&gt;
&lt;p&gt;When we are given simple numerical data, I mean simple 1 Dimensional data, one of the first things we do is to look
 at how the data is distributed i.e. find its probability distribution. The simplest thing we can do is a histogram, but it might not be the best we can do.
 So, lets generate some data that comes from a mixture of two gaussians. We will look at the most hurriedly put together histogram and then refine it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kp"&gt;set.seed&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;667&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
hist_data &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
hist_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;values&lt;span class="o"&gt;=&lt;/span&gt;hist_data&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;)&lt;/span&gt;
p_hist &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;data&lt;span class="o"&gt;=&lt;/span&gt;hist_df&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;values&lt;span class="p"&gt;),&lt;/span&gt;stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;bin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
          labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;p_hist&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-1" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-1-1.png" /&gt;&lt;/p&gt;
&lt;p&gt;So, one thing needs to be corrected first. This is not a probability density function(pdf) because the condition for a pdf is explicitly:
$$ \int_{-\infty}^{\infty} p(x) = 1 $$&lt;/p&gt;
&lt;p&gt;So, we need to normalize this histogram. But to normalize, we explicitly need to bin width. Let us assume a bin width of $w$, and lets say we have N data points. In our case, N is 200. So, What is the total area under the curve.For k bins, and a count of $C_i$ for each bin, we can write the area A as:
$$ A = \sum_{i=1}^{i=k}C_iw$$
$$ A = w\sum_{i=1}^{i=k}C_i = wN $$&lt;/p&gt;
&lt;p&gt;Therefore the normalization factor has to be w*N, or the product of bin width and the total number of 
points. Let us now explicity set a bin width and normalize:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;w &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;
break_vec &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;seq&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;from &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;w&lt;span class="p"&gt;,&lt;/span&gt; to&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;w&lt;span class="p"&gt;,&lt;/span&gt; by &lt;span class="o"&gt;=&lt;/span&gt; w&lt;span class="p"&gt;)&lt;/span&gt;
h1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; breaks&lt;span class="o"&gt;=&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt; plot&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
nhist_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;count&lt;span class="o"&gt;=&lt;/span&gt;h1&lt;span class="o"&gt;$&lt;/span&gt;counts&lt;span class="p"&gt;,&lt;/span&gt; xval &lt;span class="o"&gt;=&lt;/span&gt; h1&lt;span class="o"&gt;$&lt;/span&gt;mids&lt;span class="p"&gt;)&lt;/span&gt;
nhist_df&lt;span class="o"&gt;$&lt;/span&gt;count &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; nhist_df&lt;span class="o"&gt;$&lt;/span&gt;count&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;w&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;paste&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Area under the curve is&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;nhist_df&lt;span class="o"&gt;$&lt;/span&gt;count&lt;span class="o"&gt;*&lt;/span&gt;w&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## [1] &amp;quot;Area under the curve is 1&amp;quot;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;p_norm &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;nhist_df&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
          labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;p_norm&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-2" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-2-1.png" /&gt;&lt;/p&gt;
&lt;p&gt;That straightens out the issue about area under the curve. However, histograms aren't quite what we want. Why? because histograms show jumps which are not characateristic of the data but more characteristic of the finite sample size. We are looking to find the distribution that generated this data, and get around the finite sample size effect. &lt;/p&gt;
&lt;h2&gt;Density Estimators&lt;/h2&gt;
&lt;p&gt;To understand density estimators, let us first recreate our previous figure. How? we will not depend this time on R's built-in hist function, but make our own. Sounds like a rather fruitless exercise in coding up something rather trivial? Well, not quite. We will shortly see why.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tophat_kernel &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;&lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; x_n&lt;span class="p"&gt;,&lt;/span&gt; width&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kr"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="kp"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;-&lt;/span&gt;x_n&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;width&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2.&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;width&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kp"&gt;else&lt;/span&gt;
    &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

construct_hist &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;&lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt;width&lt;span class="p"&gt;,&lt;/span&gt; kernel_function&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  mids_vec &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; break_vec &lt;span class="o"&gt;+&lt;/span&gt; width&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
  count_vec &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;rep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;mids_vec&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="kr"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; i &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;count_vec&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;j &lt;span class="kr"&gt;in&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
      count_vec&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; count_vec&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; kernel_function&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;[&lt;/span&gt;j&lt;span class="p"&gt;],&lt;/span&gt;mids_vec&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;],&lt;/span&gt; width&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
  nhist_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;count&lt;span class="o"&gt;=&lt;/span&gt;count_vec&lt;span class="p"&gt;,&lt;/span&gt; xval &lt;span class="o"&gt;=&lt;/span&gt; mids_vec&lt;span class="p"&gt;)&lt;/span&gt;
  nhist_df&lt;span class="o"&gt;$&lt;/span&gt;count &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; nhist_df&lt;span class="o"&gt;$&lt;/span&gt;count&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;nhist_df&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

derived_nhist_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;construct_hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt; w&lt;span class="p"&gt;,&lt;/span&gt; tophat_kernel&lt;span class="p"&gt;)&lt;/span&gt;
p_norm2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;derived_nhist_df&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;
            labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;p_norm2&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-3" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-3-1.png" /&gt;&lt;/p&gt;
&lt;p&gt;Okay, so we have now introduced this double for loop, and made things run a lot slower. Why did we do this? to understand the thinking behind the histogram method of estimation. What we are trying to do here, is 
look at each of these bins (outer for loop), and for a single bin ask, for each data point (inner for loop) whether the data point contributes to the bin or not. By contribution what we mean here, is whether the data point falls in the width of the bin we have defined.
Now, notice that the sudden discontinuities arise from the way we are defining the contribution of a data point. Its a binary decision, either a data point contributes or not. However, now that we have defined this framework, we are free to change this form of the contribution. We can, for example, think of a Gaussian, where the contribution is not 0/1 but decreases exponentially from the center of the bin.
This is the basic argument of density estimation. Now, we need not stop at the Gaussian kernel, but 
substitute it with a exponential, cosine or any other kernel that makes sense. The Gaussian is the most
common kernel, so let us see what happens when we shift to it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;gaussian_kernel &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt;x_n&lt;span class="p"&gt;,&lt;/span&gt; width&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  norm_val &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="m"&gt;1.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2.&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="kc"&gt;pi&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;width&lt;span class="o"&gt;*&lt;/span&gt;width&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="kp"&gt;exp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;-&lt;/span&gt;x_n&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;width&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;norm_val&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
gauss_hist_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;construct_hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt;w&lt;span class="p"&gt;,&lt;/span&gt; gaussian_kernel&lt;span class="p"&gt;)&lt;/span&gt;
p_gauss &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;gauss_hist_df&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
            labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;p_gauss&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-4" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-4-1.png" /&gt;
On comparing the histogram(i.e. the tophat kernel with the Gaussian one) we can see
that the Gaussian has done a nice job of smoothing the kinks in the histogram.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;p_comp &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;data &lt;span class="o"&gt;=&lt;/span&gt; derived_nhist_df&lt;span class="p"&gt;,&lt;/span&gt; aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
           geom_line&lt;span class="p"&gt;(&lt;/span&gt;data&lt;span class="o"&gt;=&lt;/span&gt;gauss_hist_df&lt;span class="p"&gt;,&lt;/span&gt; aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; colour&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
           labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;p_comp&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-5" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-5-1.png" /&gt;&lt;/p&gt;
&lt;p&gt;As you can see we have managed to consirably smooth the probability density, and now we can clearly
see the outline of the more tightly distributed Gaussian, centered around 1. Why is this practically important? This gets rid of artificial kinks in the probability density. Any estimations, based on the probability density, which assumes a nicely behaved function can now be applied more easily. For example, a derivative operator will be much more well behaved, and not show the sudden jumps due to artificial kinks in the histogram. &lt;/p&gt;
&lt;p&gt;How well behaved this function is, is highly dependent on the bin width we choose, just like the histogram method is.
We have overlooked this question till now. We will leave the reader with an illustration of how the 
histogram changes with bin width.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;gauss_hist_w1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;construct_hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; gaussian_kernel&lt;span class="p"&gt;)&lt;/span&gt;
p_1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;gauss_hist_w1&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
      labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
gauss_hist_w3 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;construct_hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; gaussian_kernel&lt;span class="p"&gt;)&lt;/span&gt; 

p_3 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;gauss_hist_w3&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
      labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
gauss_hist_w4 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;construct_hist&lt;span class="p"&gt;(&lt;/span&gt;hist_data&lt;span class="p"&gt;,&lt;/span&gt; break_vec&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; gaussian_kernel&lt;span class="p"&gt;)&lt;/span&gt;
p_4 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;gauss_hist_w4&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; geom_bar&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;xval&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;count&lt;span class="p"&gt;),&lt;/span&gt; stat&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
      labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;y&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Normalized Count&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;gridExtra&lt;span class="p"&gt;)&lt;/span&gt;
grid.arrange&lt;span class="p"&gt;(&lt;/span&gt;p_1&lt;span class="p"&gt;,&lt;/span&gt;p_gauss&lt;span class="p"&gt;,&lt;/span&gt; p_3&lt;span class="p"&gt;,&lt;/span&gt;p_4&lt;span class="p"&gt;,&lt;/span&gt; ncol&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-6" src="http://souravc83.github.io/figure/density_estimate/unnamed-chunk-6-1.png" /&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sourav Chatterjee</dc:creator><pubDate>Sat, 20 Feb 2016 00:00:00 -0800</pubDate><guid>tag:souravc83.github.io,2016-02-20:whats-wrong-with-histograms-and-what-are-density-estimators.html</guid></item><item><title>Are Iowa polls predictive?</title><link>http://souravc83.github.io/are-iowa-polls-predictive.html</link><description>&lt;h1&gt;What do Iowa polls tell us?&lt;/h1&gt;
&lt;p&gt;Everyone is staring hard at the polls in Iowa and trying to predict who the winners will be.
There are data gurus, there are journalists, and everyone in between. But are these Iowa polls 
that predictive?
I decided to look at the polls 4 years ago. That, too was a hotly contested primary with about 
4 people having a decent chance. They were Paul, Romney, Santorum, Gingrich. You can find the data
&lt;a http://www.realclearpolitics.com/epolls/2012/president/ia/iowa_republican_presidential_primary-1588.html"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Just by looking at the data, you can see that most polls more than 10 days from the primary( the primary
that year was on January 3rd) are way off. So, I decided to look at the polls within the last 10 days 
of the primary. This year, we are now entering that phase, basically telling us, that everythig we 
have been seeing till now might not be very predictive either. But, were even those polls close to the 
primary predictive enough. More precisely, if we consider the margin of error in these polls because of 
sample size, did they predict the actual outcome for any of the candidates?&lt;/p&gt;
&lt;h1&gt;The Data&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;xlsx&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## Loading required package: rJava
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## Warning: package &amp;#39;rJava&amp;#39; was built under R version 3.2.3
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## Loading required package: xlsxjars
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;poll_raw &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; read.xlsx&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;polls.xlsx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;##                  Poll          Date  Sample Paul Romney Santorum Gingrich
## 1   Insider Advantage     1/1 - 1/1  729 LV   22     23       18       16
## 2             PPP (D)   12/31 - 1/1 1340 LV   20     19       18       14
## 3 Des Moines Register 12/27 - 12/30  602 LV   22     24       15       12
## 4   Rasmussen Reports 12/28 - 12/28  750 LV   22     23       16       13
## 5     NBC News/Marist 12/27 - 12/28  425 LV   21     23       15       13
## 6            CNN/Time 12/21 - 12/27  452 LV   22     25       16       14
##   Perry Bachmann Huntsman Cain    Spread
## 1    10        6        2   -- Romney +1
## 2    10        8        4   --   Paul +1
## 3    11        7        2   -- Romney +2
## 4    13        5        3   -- Romney +1
## 5    14        6        2   -- Romney +2
## 6    11        9        1   -- Romney +3
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dplyr&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## 
## Attaching package: &amp;#39;dplyr&amp;#39;
## 
## The following objects are masked from &amp;#39;package:stats&amp;#39;:
## 
##     filter, lag
## 
## The following objects are masked from &amp;#39;package:base&amp;#39;:
## 
##     intersect, setdiff, setequal, union
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;poll_raw &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; select&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;Date&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;Spread&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;Cain&lt;span class="p"&gt;)&lt;/span&gt;
poll_raw&lt;span class="o"&gt;$&lt;/span&gt;Sample &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;as.double&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kp"&gt;gsub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;\\sLV$&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;poll_raw&lt;span class="o"&gt;$&lt;/span&gt;Sample&lt;span class="p"&gt;))&lt;/span&gt;

actual &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Paul&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;21.4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Romney&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;24.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Santorum&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;24.6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Ginrich&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;13.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Perry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;10.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Bachmann&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;5.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Huntsman&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

pool &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; dplyr&lt;span class="o"&gt;::&lt;/span&gt;summarise&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt;Poll&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Pooled&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;Paul&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Paul&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt;
                         Romney&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Romney&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt; Santorum&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Santorum&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt;
                         Gingrich&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Gingrich&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt; Perry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Perry&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt;
                         Bachmann&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Bachmann&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;),&lt;/span&gt;Huntsman&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="o"&gt;*&lt;/span&gt;Huntsman&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Sample&lt;span class="p"&gt;))&lt;/span&gt;
pool&lt;span class="o"&gt;$&lt;/span&gt;Sample &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="o"&gt;$&lt;/span&gt;Sample&lt;span class="p"&gt;)&lt;/span&gt;
poll_raw &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kp"&gt;rbind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt;pool&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We have done some data cleaning, and added one more row, corresponding to a pooled vote. You can think of the pooled vote as an aggregation of all the polls. If the people in all the polls were called into a single room (I am assuming different people were polled at each vote). Pooling should increase the sample size, and eliminate the bias of individual pollsters to some extent, unless the bias
is similar for all of them. Let us see if this is indeed true.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;##                  Poll Sample     Paul   Romney Santorum Gingrich    Perry
## 1   Insider Advantage    729 22.00000 23.00000 18.00000  16.0000 10.00000
## 2             PPP (D)   1340 20.00000 19.00000 18.00000  14.0000 10.00000
## 3 Des Moines Register    602 22.00000 24.00000 15.00000  12.0000 11.00000
## 4   Rasmussen Reports    750 22.00000 23.00000 16.00000  13.0000 13.00000
## 5     NBC News/Marist    425 21.00000 23.00000 15.00000  13.0000 14.00000
## 6            CNN/Time    452 22.00000 25.00000 16.00000  14.0000 11.00000
## 7   Insider Advantage    429 17.00000 17.00000 13.00000  17.0000 11.00000
## 8             PPP (D)    565 24.00000 20.00000 10.00000  13.0000 10.00000
## 9              Pooled   5292 21.22147 21.46504 15.70408  13.9624 11.02664
##    Bachmann Huntsman
## 1  6.000000 2.000000
## 2  8.000000 4.000000
## 3  7.000000 2.000000
## 4  5.000000 3.000000
## 5  6.000000 2.000000
## 6  9.000000 1.000000
## 7 12.000000 3.000000
## 8 11.000000 4.000000
## 9  7.754913 2.857332
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Polls for the top three candidates&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;candidate_plot &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt;&lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_df&lt;span class="p"&gt;,&lt;/span&gt; actual_vec&lt;span class="p"&gt;,&lt;/span&gt; cand_name&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggplot2&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;ggthemes&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;lazyeval&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="kn"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;dplyr&lt;span class="p"&gt;)&lt;/span&gt;
  cand_actual &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;actual_vec&lt;span class="p"&gt;[&lt;/span&gt;cand_name&lt;span class="p"&gt;])&lt;/span&gt;

  mutate_call &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lazyeval&lt;span class="o"&gt;::&lt;/span&gt;interp&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="m"&gt;100.&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;1.96&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="kp"&gt;sqrt&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; a&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;100.&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1.&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;a&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;100.&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;b&lt;span class="p"&gt;),&lt;/span&gt; a&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;as.name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cand_name&lt;span class="p"&gt;),&lt;/span&gt; b&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;as.name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Sample&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  poll_df &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; poll_df&lt;span class="o"&gt;%&amp;gt;%&lt;/span&gt;mutate_&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;.&lt;/span&gt;dots&lt;span class="o"&gt;=&lt;/span&gt;setNames&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kt"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;mutate_call&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;err_bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

  cand_plot &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; ggplot&lt;span class="p"&gt;(&lt;/span&gt;data&lt;span class="o"&gt;=&lt;/span&gt;poll_df&lt;span class="p"&gt;,&lt;/span&gt; environment&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kp"&gt;environment&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;geom_point&lt;span class="p"&gt;(&lt;/span&gt;aes_string&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Poll&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;cand_name&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
                geom_errorbar&lt;span class="p"&gt;(&lt;/span&gt;aes_string&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Poll&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;ymin &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;paste0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cand_name&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;- err_bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
                                         ymax&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kp"&gt;paste0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cand_name&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;+ err_bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; width&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; colour&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;
               geom_hline&lt;span class="p"&gt;(&lt;/span&gt;aes&lt;span class="p"&gt;(&lt;/span&gt;yintercept &lt;span class="o"&gt;=&lt;/span&gt; cand_actual&lt;span class="p"&gt;),&lt;/span&gt; colour&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;

               labs&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Poll Name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="o"&gt;=&lt;/span&gt;cand_name&lt;span class="p"&gt;,&lt;/span&gt; title&lt;span class="o"&gt;=&lt;/span&gt;cand_name&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt;
               theme_fivethirtyeight&lt;span class="p"&gt;(&lt;/span&gt;base_size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;24&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;theme&lt;span class="p"&gt;(&lt;/span&gt;axis.text.x &lt;span class="o"&gt;=&lt;/span&gt; element_text&lt;span class="p"&gt;(&lt;/span&gt;angle &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; hjust &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

  &lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;cand_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
Paul_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## Warning: package &amp;#39;ggplot2&amp;#39; was built under R version 3.2.3
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;## Warning: package &amp;#39;ggthemes&amp;#39; was built under R version 3.2.3
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Paul_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-4" src="figure/unnamed-chunk-4-1.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Romney_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Romney&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Romney_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-4" src="figure/unnamed-chunk-4-2.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Santorum_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Santorum&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Santorum_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-4" src="figure/unnamed-chunk-4-3.png" /&gt; &lt;/p&gt;
&lt;p&gt;The polls did a good job only for Ron Paul. For Romney, many polls were within a margin of error, and 
the pooled poll underestimates Romney's support. In the case of Santorum (who actually won the Caucus), the polls are waay off!
Every poll has underestimated Santorum. The pooled poll shows him at 15.7, about 9 points away from his 
final support! That basically says, add or substract 9 points of error margin to the polls that you 
see today, if 2012 is still the state-of-the-art in terms of polls.
Well, that kind of answers our question. These polls aren't doing a good job. However, they are still good at identifying the top three people. &lt;/p&gt;
&lt;p&gt;But there is another interesting trend. Except for Ron Paul, the polls underestimate the support for the 
two leading candidates. Why is that? My guess would be that this is because it overestimates the support for the other candidates. Starting from 10 days before the polls, slowly, public opinion converged, 
and people who were considering candidates like Bachmann etc. realized that they are not going to waste their vote on a candidate who is most likely to lose. Support slowly consolidated to the top three candidates. &lt;/p&gt;
&lt;p&gt;This time again, a similar thing is probably going to happen. Whoever wins, I think slowly support will 
be consolidated towards Trump, Cruz and probably Rubio, and the rest of the candidates should see a 
clear decline in poll numbers. Let us look at some of the worst performing candidates to see how their numbers were overestimated.&lt;/p&gt;
&lt;h1&gt;Polls for the other candidates&lt;/h1&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Bachmann_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Bachmann&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Bachmann_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-5" src="figure/unnamed-chunk-5-1.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Huntsman_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Huntsman&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Huntsman_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-5" src="figure/unnamed-chunk-5-2.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Perry_plot &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt; actual&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Perry&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Perry_plot&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-5" src="figure/unnamed-chunk-5-3.png" /&gt; &lt;/p&gt;
&lt;p&gt;The support for both Huntsmann and Bachmann are severely overestimated. The pooled plot 
for them clearly shows that the polls did not do a good job for them. So why did the polls 
do a good job in predicting Ron Paul? Probably because Paul has a dedicated set of supporters
who are not ones who change their minds. The people who changed their minds mostly went to 
Santorum. This was probably evangelical support slipping away from Bachmann, and progressive 
support going to Romney. Paul's supporters are a liberterian group, who have a very fixed ideology.
So therefore, what really causes these polls to go bad is the fact that most people make up/change
their mind at the end, and move from flirting with unwinnable candidates to more pragmatic choices.&lt;/p&gt;
&lt;h1&gt;A perhaps better way of looking at the polls&lt;/h1&gt;
&lt;p&gt;So, lets delete the people who never made it, and see if the polls do a better job at predicting the 
cage match between the top three candidates. There will be some sleight of hand to normalize everything
including the sample size for the polls. We will only consider the people who chose the top 3 candidates.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;poll_three &lt;span class="o"&gt;=&lt;/span&gt; dplyr&lt;span class="o"&gt;::&lt;/span&gt;select&lt;span class="p"&gt;(&lt;/span&gt;poll_raw&lt;span class="p"&gt;,&lt;/span&gt;Poll&lt;span class="p"&gt;,&lt;/span&gt;Sample&lt;span class="p"&gt;,&lt;/span&gt; Paul&lt;span class="p"&gt;,&lt;/span&gt; Romney&lt;span class="p"&gt;,&lt;/span&gt; Santorum&lt;span class="p"&gt;)&lt;/span&gt;
poll_three &lt;span class="o"&gt;=&lt;/span&gt; dplyr&lt;span class="o"&gt;::&lt;/span&gt;mutate&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt; total &lt;span class="o"&gt;=&lt;/span&gt; Paul&lt;span class="o"&gt;+&lt;/span&gt;Romney&lt;span class="o"&gt;+&lt;/span&gt;Santorum&lt;span class="p"&gt;)&lt;/span&gt;
poll_three &lt;span class="o"&gt;=&lt;/span&gt; dplyr&lt;span class="o"&gt;::&lt;/span&gt;mutate&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt; Sample &lt;span class="o"&gt;=&lt;/span&gt; Sample&lt;span class="o"&gt;*&lt;/span&gt;total&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="m"&gt;100.&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; Romney &lt;span class="o"&gt;=&lt;/span&gt; Romney&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;total&lt;span class="p"&gt;,&lt;/span&gt;
                            Paul &lt;span class="o"&gt;=&lt;/span&gt; Paul&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;total&lt;span class="p"&gt;,&lt;/span&gt; Santorum &lt;span class="o"&gt;=&lt;/span&gt; Santorum&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;total&lt;span class="p"&gt;)&lt;/span&gt;
poll_three &lt;span class="o"&gt;=&lt;/span&gt; dplyr&lt;span class="o"&gt;::&lt;/span&gt;filter&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt;Poll&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Pooled&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;%&amp;gt;%&lt;/span&gt;select&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;total&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;##                  Poll Sample     Paul   Romney Santorum
## 1   Insider Advantage 459.27 34.92063 36.50794 28.57143
## 2             PPP (D) 763.80 35.08772 33.33333 31.57895
## 3 Des Moines Register 367.22 36.06557 39.34426 24.59016
## 4   Rasmussen Reports 457.50 36.06557 37.70492 26.22951
## 5     NBC News/Marist 250.75 35.59322 38.98305 25.42373
## 6            CNN/Time 284.76 34.92063 39.68254 25.39683
## 7   Insider Advantage 201.63 36.17021 36.17021 27.65957
## 8             PPP (D) 305.10 44.44444 37.03704 18.51852
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;#make sure this is 100&lt;/span&gt;
&lt;span class="c1"&gt;#poll_three$Paul+poll_three$Romney + poll_three$Santorum&lt;/span&gt;

actual_three &lt;span class="o"&gt;=&lt;/span&gt; actual&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="kt"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Romney&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Santorum&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
actual_three &lt;span class="o"&gt;=&lt;/span&gt;actual_three&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="kp"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;actual_three&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;actual_three&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;##     Paul   Romney Santorum 
## 30.35461 34.75177 34.89362
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Okay, so, now we have basically normalized everything as a "cage match"(the term Cruz loves to use)
between the three. Here is how the polls now shape up, for the three candidates&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Paul_plot3 &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt; actual_three&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Paul_plot3&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-7" src="figure/unnamed-chunk-7-1.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Romney_plot3 &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt; actual_three&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Romney&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Romney_plot3&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-7" src="figure/unnamed-chunk-7-2.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Santorum_plot3 &lt;span class="o"&gt;=&lt;/span&gt; candidate_plot&lt;span class="p"&gt;(&lt;/span&gt;poll_three&lt;span class="p"&gt;,&lt;/span&gt; actual_three&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Santorum&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kp"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;Santorum_plot3&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk unnamed-chunk-7" src="figure/unnamed-chunk-7-3.png" /&gt; 
Well, we now have the polls slightly overpredicting Romney and Paul, and still underpredicting 
Santorum. Hoever, notice that almost every poll is now grazing the margin for Romney and 
Paul, and there is one poll which is within the error bars for Santorun. Which one is this?
The late PPP poll (12/31-1/1) with 1340 respondents. This is the poll which has the highest sample
size and is within three days of when Iowa went to the polls. This poll does a good job for all 
three candidates(slightly missing the mark for Paul).
So therefore, this is a kind of poll I would look forward to. &lt;/p&gt;
&lt;p&gt;In conclusion, take all these Iowa polls and their wild fluctuations with many pinches of salt.
People have just started making up their mind and consolidating. If you want a predictive poll, 
I would look for one about 3/4 days from Iowa caucus, with a large sample size (perhaps PPP will 
do another one this time), and then look at the top 3 candidates there (which will, in all 
probability be Trump-Cruz-Rubio). Ignore everyone else, because people will not vote for "losers", as
Trump would say. &lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Sourav Chatterjee</dc:creator><pubDate>Sat, 23 Jan 2016 00:00:00 -0800</pubDate><guid>tag:souravc83.github.io,2016-01-23:are-iowa-polls-predictive.html</guid></item></channel></rss>